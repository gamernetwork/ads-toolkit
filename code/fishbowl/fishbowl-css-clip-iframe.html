<!-- FISH BOWL AD -->
<div id="fishbowl-move-this">

    <!-- The Fish Bowl Image -->
    <div id="fishbowl">
        <div id="fishbowl-bg">
            <a href="%%CLICK_URL_UNESC%%YOUR_LINK_HERE" title="Click-through" target="_blank">
                <img id="fishbowl-img" width="100%" />
            </a>
        </div>
    </div>

    <!-- The Fish Bowl MPU Fallback -->
    <a href="%%CLICK_URL_UNESC%%YOUR_LINK_HERE" title="Click-through" target="_blank" class="fishbowl-ad">
        <div id="fishbowl-fallback" style="display:none;">
        </div>
    </a>

    <style>
        #fishbowl {
            width: 300px;
            height: 400px;
            position: absolute;
            top: 0px;
            left: -10px;
        }
        #fishbowl-bg {
            width: 300px;
            height: 0px;
            overflow: hidden;
            position: absolute;
            opacity: 0.001;
        }
        #fishbowl-img {
            position: fixed;
            top: 0px;
            left: 0px;
            backface-visibility: hidden;
        }
        #fishbowl-fallback {
            display: block;
            width: 325px;
            height: 400px;
            background-image: url(YOUR_FALLBACK_IMAGE_HERE);
            background-repeat: no-repeat;
            background-position: 0px -47px;
        }
        #fishbowl:after {
            content: 'Advertisement';
            position: absolute;
            display: inline-block;
            text-align: left;
            text-transform: uppercase;
            color: #EEE;
            font-size: 11px;
            padding: 10px 20px 2px;
            font-family: 'Helvetica Neue', Helvetica, sans-serif;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            z-index: 10;
        }
    </style>

</div>

<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>

<script type="text/javascript">

    var j = jQuery.noConflict();

    var fishbowl_container = document.getElementById('fishbowl-move-this');
    top.document.getElementById('mobile-mpu').appendChild(fishbowl_container);

    function fishbowl_scale() {

        var fishbowl = parent.j('#fishbowl');
        var fishbowlFallback = parent.j('#fishbowl-fallback');

        //checks if the user is using portrait or landscape
        if (window.parent.innerHeight > window.parent.innerWidth) {
            //Portrait mode so show fish bowl
            fishbowl.css('width', window.parent.innerWidth + 'px');

            parent.j('#fishbowl-bg').css({
                'opacity': '1',
                'width': window.parent.innerWidth + 'px',
                'height': '400px',
                'clip': 'rect(0, ' + window.parent.innerWidth + 'px, 400px, 0)'
            });

            fishbowl.show();
            fishbowlFallback.hide();

            ga('showcase.send', 'event', 'Fish Bowl', 'View Fish Bowl', '{line.id}');

        } else {
            // Display fallback MPU
            fishbowlFallback.show();
            fishbowl.hide();

            ga('showcase.send', 'event', 'Fish Bowl', 'View Fallback MPU', '{line.id}');

        }

    }


    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-23103987-1', 'auto', {
        'name': 'showcase'
    });
    
    var mobileMPU = parent.j("#mobile-mpu");
    mobileMPU.css('margin-bottom', '0');
    
    //waits for the ad image to load
    parent.j('#fishbowl-img').load(function () {
        //Timeout of 200 milliseconds, gives it a bit of time before the clip takes place
        setTimeout(function () {
            //runs an initial scale
            fishbowl_scale();
            
            //resizes the add as it is now ready
            mobileMPU.css({
                'width': '0',
                'margin': '0',
                'position': 'relative'
            });

            mobileMPU.css('margin-bottom', '20px');
            mobileMPU.css('height', '400px');
        }, 200);
        
        //run scale every time the window resizes
        j(window.parent).resize(fishbowl_scale);
    }).attr('src', 'YOUR_FISHBOWL_IMAGE_HERE');

</script>
